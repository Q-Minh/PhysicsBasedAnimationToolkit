<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.13.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PhysicsBasedAnimationToolkit: pbat::geometry::ClosestPointQueries Namespace Reference</title>
  <link rel="icon" href="../../entei.icon.png" type="image/x-icon" />
  <link href="../../tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="../../jquery.js"></script>
  <script type="text/javascript" src="../../dynsections.js"></script>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
  <!-- BEGIN Doxygen Awesome -->
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeParagraphLink.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeTabs.init()
  </script>
  <!-- END Doxygen Awesome -->
  <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
  <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
  <link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="../../pbat.svg"  /></td>
              <td id="projectalign">
                <div id="projectname">PhysicsBasedAnimationToolkit<span
                    id="projectnumber">&#160;0.0.10</span>
                </div>
                <div id="projectbrief">Cross-platform C++20 library of algorithms and data structures commonly used in computer graphics research on physically-based simulation.</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/d8a/namespacepbat_1_1geometry_1_1_closest_point_queries.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pbat::geometry::ClosestPointQueries Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This namespace contains functions to answer closest point queries.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad900de30d0cd300416621055cb70c99a" id="r_ad900de30d0cd300416621055cb70c99a"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixP, mini::CMatrix TMatrixN&gt; </td></tr>
<tr class="memitem:ad900de30d0cd300416621055cb70c99a"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ad900de30d0cd300416621055cb70c99a">PointOnPlane</a> (TMatrixX const &amp;X, TMatrixP const &amp;P, TMatrixN const &amp;n) -&gt; mini::SVector&lt; typename TMatrixX::ScalarType, TMatrixX::kRows &gt;</td></tr>
<tr class="memdesc:ad900de30d0cd300416621055cb70c99a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point on the plane (P,n) closest to the point X.  <br /></td></tr>
<tr class="separator:ad900de30d0cd300416621055cb70c99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eaee3eb7c712e36208694cbfcfbb411" id="r_a6eaee3eb7c712e36208694cbfcfbb411"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixP, mini::CMatrix TMatrixQ&gt; </td></tr>
<tr class="memitem:a6eaee3eb7c712e36208694cbfcfbb411"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a6eaee3eb7c712e36208694cbfcfbb411">PointOnLineSegment</a> (TMatrixX const &amp;X, TMatrixP const &amp;P, TMatrixQ const &amp;Q) -&gt; mini::SVector&lt; typename TMatrixX::ScalarType, TMatrixX::kRows &gt;</td></tr>
<tr class="memdesc:a6eaee3eb7c712e36208694cbfcfbb411"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point on the line segment PQ closest to the point X.  <br /></td></tr>
<tr class="separator:a6eaee3eb7c712e36208694cbfcfbb411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db9446b378bf60a48b502a284e03e17" id="r_a6db9446b378bf60a48b502a284e03e17"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixL, mini::CMatrix TMatrixU&gt; </td></tr>
<tr class="memitem:a6db9446b378bf60a48b502a284e03e17"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a6db9446b378bf60a48b502a284e03e17">PointOnAxisAlignedBoundingBox</a> (TMatrixX const &amp;X, TMatrixL const &amp;L, TMatrixU const &amp;U) -&gt; mini::SVector&lt; typename TMatrixX::ScalarType, TMatrixX::kRows &gt;</td></tr>
<tr class="memdesc:a6db9446b378bf60a48b502a284e03e17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point on the axis-aligned bounding box (AABB) defined by the lower and upper corners closest to the point X.  <br /></td></tr>
<tr class="separator:a6db9446b378bf60a48b502a284e03e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6b2ac8ad3f344c1acb78207a36c37d" id="r_a6f6b2ac8ad3f344c1acb78207a36c37d"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC&gt; </td></tr>
<tr class="memitem:a6f6b2ac8ad3f344c1acb78207a36c37d"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a6f6b2ac8ad3f344c1acb78207a36c37d">UvwPointInTriangle</a> (TMatrixP const &amp;P, TMatrixA const &amp;A, TMatrixB const &amp;B, TMatrixC const &amp;C) -&gt; mini::SVector&lt; typename TMatrixP::ScalarType, 3 &gt;</td></tr>
<tr class="memdesc:a6f6b2ac8ad3f344c1acb78207a36c37d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point on the triangle ABC closest to the point P in barycentric coordinates.  <br /></td></tr>
<tr class="separator:a6f6b2ac8ad3f344c1acb78207a36c37d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa91aae1977b26342000f4f72dc924b" id="r_affa91aae1977b26342000f4f72dc924b"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC&gt; </td></tr>
<tr class="memitem:affa91aae1977b26342000f4f72dc924b"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#affa91aae1977b26342000f4f72dc924b">PointInTriangle</a> (TMatrixP const &amp;P, TMatrixA const &amp;A, TMatrixB const &amp;B, TMatrixC const &amp;C) -&gt; mini::SVector&lt; typename TMatrixP::ScalarType, TMatrixP::kRows &gt;</td></tr>
<tr class="memdesc:affa91aae1977b26342000f4f72dc924b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point on the triangle ABC closest to the point P.  <br /></td></tr>
<tr class="separator:affa91aae1977b26342000f4f72dc924b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9377f88e20b763e1be19f7dd03de81c" id="r_ac9377f88e20b763e1be19f7dd03de81c"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC, mini::CMatrix TMatrixD&gt; </td></tr>
<tr class="memitem:ac9377f88e20b763e1be19f7dd03de81c"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ac9377f88e20b763e1be19f7dd03de81c">PointInTetrahedron</a> (TMatrixP const &amp;P, TMatrixA const &amp;A, TMatrixB const &amp;B, TMatrixC const &amp;C, TMatrixD const &amp;D) -&gt; mini::SVector&lt; typename TMatrixP::ScalarType, TMatrixP::kRows &gt;</td></tr>
<tr class="memdesc:ac9377f88e20b763e1be19f7dd03de81c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the point in the tetrahedron ABCD closest to the point P. The order of ABCD must be such that all faces ABC, ACD, ADB and BDC are oriented with outwards pointing normals when viewed from outside the tetrahedron.  <br /></td></tr>
<tr class="separator:ac9377f88e20b763e1be19f7dd03de81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeea6e8a7f850285e39ec56410e1a9f4" id="r_aaeea6e8a7f850285e39ec56410e1a9f4"><td class="memTemplParams" colspan="2">template&lt;mini::CMatrix TMatrixP1, mini::CMatrix TMatrixQ1, mini::CMatrix TMatrixP2, mini::CMatrix TMatrixQ2, class TScalar = typename TMatrixP1::ScalarType&gt; </td></tr>
<tr class="memitem:aaeea6e8a7f850285e39ec56410e1a9f4"><td class="memTemplItemLeft" align="right" valign="top">PBAT_HOST_DEVICE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aaeea6e8a7f850285e39ec56410e1a9f4">Lines</a> (TMatrixP1 const &amp;P1, TMatrixQ1 const &amp;Q1, TMatrixP2 const &amp;P2, TMatrixQ2 const &amp;Q2, TScalar eps=std::numeric_limits&lt; TScalar &gt;::min()) -&gt; mini::SVector&lt; TScalar, 2 &gt;</td></tr>
<tr class="memdesc:aaeea6e8a7f850285e39ec56410e1a9f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find closest points on two lines defined by points P1, Q1 and P2, Q2.  <br /></td></tr>
<tr class="separator:aaeea6e8a7f850285e39ec56410e1a9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This namespace contains functions to answer closest point queries. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aaeea6e8a7f850285e39ec56410e1a9f4" name="aaeea6e8a7f850285e39ec56410e1a9f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeea6e8a7f850285e39ec56410e1a9f4">&#9670;&#160;</a></span>Lines()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixP1, mini::CMatrix TMatrixQ1, mini::CMatrix TMatrixP2, mini::CMatrix TMatrixQ2, class TScalar = typename TMatrixP1::ScalarType&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::Lines </td>
          <td>(</td>
          <td class="paramtype">TMatrixP1 const &amp;</td>          <td class="paramname"><span class="paramname"><em>P1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixQ1 const &amp;</td>          <td class="paramname"><span class="paramname"><em>Q1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixP2 const &amp;</td>          <td class="paramname"><span class="paramname"><em>P2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixQ2 const &amp;</td>          <td class="paramname"><span class="paramname"><em>Q2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TScalar</td>          <td class="paramname"><span class="paramname"><em>eps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::numeric_limits&lt;TScalar&gt;::min()</span>&#160;) -&gt; mini::SVector&lt;TScalar, 2&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find closest points on two lines defined by points P1, Q1 and P2, Q2. </p>
<p>We find closest points by minimizing      </p><p class="formulaDsp">
\[\begin{align*}
f(\alpha, \beta) &amp;= | (P1 + \alpha d_1) - (P2 + \beta d_2) |^2 \\
&amp;= | (P1 - P2) + (\alpha d_1 - \beta d_2) |^2 ,
\end{align*}
\]
</p>
<p> where \( d_1 = Q1 - P1 \) and \( d_2 = Q2 - P2 \).</p>
<p>We can expand \( f \) to obtain        </p><p class="formulaDsp">
\[\begin{align*}
f(\alpha,\beta) &amp;= |P1-P2|^2 + 2 (P1-P2)^T (\alpha d_1 - \beta d_2) + | (\alpha d_1 - \beta d_2)
|^2 \\
&amp;= |P1-P2|^2 + 2 (P1-P2)^T (\alpha d_1 - \beta d_2) + \alpha^2 |d_1|^2 - 2 \alpha \beta d_1^T d_2
+ \beta^2 |d_2|^2 .
\end{align*}
\]
</p>
<p>The gradients are thus      </p><p class="formulaDsp">
\[\begin{align*}
\frac{\partial f}{\partial \alpha} &amp;= 2 (P1-P2)^T d_1 + 2 \alpha |d_1|^2 - 2 \beta d_1^T d_2 \\
\frac{\partial f}{\partial \beta} &amp;= -2 (P1-P2)^T d_2 - 2 \alpha d_1^T d_2 + 2 \beta |d_2|^2
\end{align*}
\]
</p>
<p>Setting the gradients to zero, we obtain the following equations       </p><p class="formulaDsp">
\[\begin{align*}
\beta &amp;= \frac{(P1-P2)^T d_2 + \alpha d_1^T d_2}{|d_2|^2} \\
&amp;= \frac{(P1-P2+\alpha d_1)^T d_2}{|d_2|^2} \\
\alpha &amp;= \frac{\beta d_1^T d_2 - (P1-P2)^T d_1}{|d_1|^2} .
\end{align*}
\]
</p>
<p>Injecting the first equation into the second, we obtain             </p><p class="formulaDsp">
\[\begin{align*}
\alpha &amp;= \frac{-(P1-P2)^T d_1}{|d_1|^2} + \frac{(P1-P2)^T d_2 + \alpha d_1^T d_2}{|d_1|^2
|d_2|^2} d_1^T d_2 \\
\alpha &amp;= \frac{-(P1-P2)^T d_1}{|d_1|^2} + \frac{(P1-P2)^T d_2}{|d_1|^2 |d_2|^2} d_1^T d_2 +
\alpha \frac{(d_1^T d_2)^2}{|d_1|^2 |d_2|^2} \\
(1 - \frac{(d_1^T d_2)^2}{|d_1|^2 |d_2|^2}) \alpha &amp;= \frac{-(P1-P2)^T d_1}{|d_1|^2} +
\frac{(P1-P2)^T d_2}{|d_1|^2 |d_2|^2} d_1^T d_2 \\
(1 - \frac{(d_1^T d_2)^2}{|d_1|^2 |d_2|^2}) \alpha &amp;= \frac{(P1-P2)^T (d_2 d_1^T d_2 - |d_2|^2
d_1)}{|d_1|^2 |d_2|^2} \\
(|d_1|^2 |d_2|^2 - (d_1^T d_2)^2) \alpha &amp;= (P1-P2)^T (d_2 d_1^T d_2 - |d_2|^2 d_1) .
\end{align*}
\]
</p>
<p> which allows solving for \( \alpha \) first, then \( \beta \).</p>
<p>Note that if the lines are parallel, then by definition,        </p><p class="formulaDsp">
\[\begin{align*}
d_1^T d_2 &amp;= |d_1| |d_2| \cos(\theta) \\
&amp;= |d_1| |d_2| \\
(d_1^T d_2)^2 &amp;= |d_1|^2 |d_2|^2 \\
|d_1|^2 |d_2|^2 - (d_1^T d_2)^2 &amp;= 0 .
\end{align*}
\]
</p>
<p>In that case, we choose \( \alpha = 0 \) and return the corresponding \( \beta \). If any line \( d_i = 0 \), it is degenerated into a point. In that case, we choose the closest point on the other line. If both lines are degenerated into points, the solution is \( \alpha, \beta = 0 \).</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixP1</td><td>Type of the input matrix P1 </td></tr>
    <tr><td class="paramname">TMatrixQ1</td><td>Type of the input matrix Q1 </td></tr>
    <tr><td class="paramname">TMatrixP2</td><td>Type of the input matrix P2 </td></tr>
    <tr><td class="paramname">TMatrixQ2</td><td>Type of the input matrix Q2 </td></tr>
    <tr><td class="paramname">TScalar</td><td>Type of the scalar </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1</td><td>Point 1 on line 1 </td></tr>
    <tr><td class="paramname">Q1</td><td>Point 2 on line 1 </td></tr>
    <tr><td class="paramname">P2</td><td>Point 1 on line 2 </td></tr>
    <tr><td class="paramname">Q2</td><td>Point 2 on line 2 </td></tr>
    <tr><td class="paramname">eps</td><td>Numerical error tolerance for zero checks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2-vector \( (\alpha, \beta) \) such that the closest points are  \( P1 + \alpha * (Q1 -
P1) \) and \( P2 + \beta * (Q2 - P2) \) </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>eps &gt;= 0</code> </dd></dl>

</div>
</div>
<a id="ac9377f88e20b763e1be19f7dd03de81c" name="ac9377f88e20b763e1be19f7dd03de81c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9377f88e20b763e1be19f7dd03de81c">&#9670;&#160;</a></span>PointInTetrahedron()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC, mini::CMatrix TMatrixD&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::PointInTetrahedron </td>
          <td>(</td>
          <td class="paramtype">TMatrixP const &amp;</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixA const &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixB const &amp;</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixC const &amp;</td>          <td class="paramname"><span class="paramname"><em>C</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixD const &amp;</td>          <td class="paramname"><span class="paramname"><em>D</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixP::ScalarType, TMatrixP::kRows&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point in the tetrahedron ABCD closest to the point P. The order of ABCD must be such that all faces ABC, ACD, ADB and BDC are oriented with outwards pointing normals when viewed from outside the tetrahedron. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixP</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixA</td><td>Vertex A of the tetrahedron matrix type </td></tr>
    <tr><td class="paramname">TMatrixB</td><td>Vertex B of the tetrahedron matrix type </td></tr>
    <tr><td class="paramname">TMatrixC</td><td>Vertex C of the tetrahedron matrix type </td></tr>
    <tr><td class="paramname">TMatrixD</td><td>Vertex D of the tetrahedron matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>Query point </td></tr>
    <tr><td class="paramname">A</td><td>Vertex A of the tetrahedron </td></tr>
    <tr><td class="paramname">B</td><td>Vertex B of the tetrahedron </td></tr>
    <tr><td class="paramname">C</td><td>Vertex C of the tetrahedron </td></tr>
    <tr><td class="paramname">D</td><td>Vertex D of the tetrahedron </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point in the tetrahedron closest to P </dd></dl>
<p>See <a class="el" href="../../d0/de3/citelist.html#CITEREF_ericson2004real">[5]</a> section 5.16</p>

</div>
</div>
<a id="affa91aae1977b26342000f4f72dc924b" name="affa91aae1977b26342000f4f72dc924b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affa91aae1977b26342000f4f72dc924b">&#9670;&#160;</a></span>PointInTriangle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::PointInTriangle </td>
          <td>(</td>
          <td class="paramtype">TMatrixP const &amp;</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixA const &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixB const &amp;</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixC const &amp;</td>          <td class="paramname"><span class="paramname"><em>C</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixP::ScalarType, TMatrixP::kRows&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point on the triangle ABC closest to the point P. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixP</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixA</td><td>Vertex A of the triangle matrix type </td></tr>
    <tr><td class="paramname">TMatrixB</td><td>Vertex B of the triangle matrix type </td></tr>
    <tr><td class="paramname">TMatrixC</td><td>Vertex C of the triangle matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>Query point </td></tr>
    <tr><td class="paramname">A</td><td>Vertex A of the triangle </td></tr>
    <tr><td class="paramname">B</td><td>Vertex B of the triangle </td></tr>
    <tr><td class="paramname">C</td><td>Vertex C of the triangle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point in the triangle closest to P </dd></dl>

</div>
</div>
<a id="a6db9446b378bf60a48b502a284e03e17" name="a6db9446b378bf60a48b502a284e03e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db9446b378bf60a48b502a284e03e17">&#9670;&#160;</a></span>PointOnAxisAlignedBoundingBox()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixL, mini::CMatrix TMatrixU&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::PointOnAxisAlignedBoundingBox </td>
          <td>(</td>
          <td class="paramtype">TMatrixX const &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixL const &amp;</td>          <td class="paramname"><span class="paramname"><em>L</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixU const &amp;</td>          <td class="paramname"><span class="paramname"><em>U</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixX::ScalarType, TMatrixX::kRows&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point on the axis-aligned bounding box (AABB) defined by the lower and upper corners closest to the point X. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixX</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixL</td><td>Lower corner of the AABB matrix type </td></tr>
    <tr><td class="paramname">TMatrixU</td><td>Upper corner of the AABB matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>Query point </td></tr>
    <tr><td class="paramname">L</td><td>Lower corner of the AABB </td></tr>
    <tr><td class="paramname">U</td><td>Upper corner of the AABB </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point on the AABB closest to X </dd></dl>
<p>See <a class="el" href="../../d0/de3/citelist.html#CITEREF_ericson2004real">[5]</a> section 5.13</p>

</div>
</div>
<a id="a6eaee3eb7c712e36208694cbfcfbb411" name="a6eaee3eb7c712e36208694cbfcfbb411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eaee3eb7c712e36208694cbfcfbb411">&#9670;&#160;</a></span>PointOnLineSegment()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixP, mini::CMatrix TMatrixQ&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::PointOnLineSegment </td>
          <td>(</td>
          <td class="paramtype">TMatrixX const &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixP const &amp;</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixQ const &amp;</td>          <td class="paramname"><span class="paramname"><em>Q</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixX::ScalarType, TMatrixX::kRows&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point on the line segment PQ closest to the point X. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixX</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixP</td><td>Start point of the line segment matrix type </td></tr>
    <tr><td class="paramname">TMatrixQ</td><td>End point of the line segment matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>Query point </td></tr>
    <tr><td class="paramname">P</td><td>Start point of the line segment </td></tr>
    <tr><td class="paramname">Q</td><td>End point of the line segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point on the line segment closest to X </dd></dl>
<p>See <a class="el" href="../../d0/de3/citelist.html#CITEREF_ericson2004real">[5]</a> section 5.12</p>

</div>
</div>
<a id="ad900de30d0cd300416621055cb70c99a" name="ad900de30d0cd300416621055cb70c99a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad900de30d0cd300416621055cb70c99a">&#9670;&#160;</a></span>PointOnPlane()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixX, mini::CMatrix TMatrixP, mini::CMatrix TMatrixN&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::PointOnPlane </td>
          <td>(</td>
          <td class="paramtype">TMatrixX const &amp;</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixP const &amp;</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixN const &amp;</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixX::ScalarType, TMatrixX::kRows&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point on the plane (P,n) closest to the point X. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixX</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixP</td><td>Point on the plane matrix type </td></tr>
    <tr><td class="paramname">TMatrixN</td><td>Normal of the plane matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>Query point </td></tr>
    <tr><td class="paramname">P</td><td>Point on the plane </td></tr>
    <tr><td class="paramname">n</td><td>Normal of the plane </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point on the plane closest to X </dd></dl>
<p>See <a class="el" href="../../d0/de3/citelist.html#CITEREF_ericson2004real">[5]</a> section 5.11</p>

</div>
</div>
<a id="a6f6b2ac8ad3f344c1acb78207a36c37d" name="a6f6b2ac8ad3f344c1acb78207a36c37d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f6b2ac8ad3f344c1acb78207a36c37d">&#9670;&#160;</a></span>UvwPointInTriangle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;mini::CMatrix TMatrixP, mini::CMatrix TMatrixA, mini::CMatrix TMatrixB, mini::CMatrix TMatrixC&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">PBAT_HOST_DEVICE auto pbat::geometry::ClosestPointQueries::UvwPointInTriangle </td>
          <td>(</td>
          <td class="paramtype">TMatrixP const &amp;</td>          <td class="paramname"><span class="paramname"><em>P</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixA const &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixB const &amp;</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixC const &amp;</td>          <td class="paramname"><span class="paramname"><em>C</em></span>&#160;) -&gt; mini::SVector&lt;typename TMatrixP::ScalarType, 3&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain the point on the triangle ABC closest to the point P in barycentric coordinates. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TMatrixP</td><td>Query point matrix type </td></tr>
    <tr><td class="paramname">TMatrixA</td><td>Vertex A of the triangle matrix type </td></tr>
    <tr><td class="paramname">TMatrixB</td><td>Vertex B of the triangle matrix type </td></tr>
    <tr><td class="paramname">TMatrixC</td><td>Vertex C of the triangle matrix type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td>Query point </td></tr>
    <tr><td class="paramname">A</td><td>Vertex A of the triangle </td></tr>
    <tr><td class="paramname">B</td><td>Vertex B of the triangle </td></tr>
    <tr><td class="paramname">C</td><td>Vertex C of the triangle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Barycentric coordinates of the point in the triangle closest to P </dd></dl>
<p>See <a class="el" href="../../d0/de3/citelist.html#CITEREF_ericson2004real">[5]</a> section 5.15</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d7c/namespacepbat.html">pbat</a></li><li class="navelem"><a class="el" href="../../d2/d7a/namespacepbat_1_1geometry.html">geometry</a></li><li class="navelem"><a class="el" href="../../dd/d8a/namespacepbat_1_1geometry_1_1_closest_point_queries.html">ClosestPointQueries</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
