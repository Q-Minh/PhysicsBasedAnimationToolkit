<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.13.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PhysicsBasedAnimationToolkit: pbat::sim::integration::Bdf&lt; TScalar, TIndex &gt; Class Template Reference</title>
  <link rel="icon" href="../../entei.icon.png" type="image/x-icon" />
  <link href="../../tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="../../jquery.js"></script>
  <script type="text/javascript" src="../../dynsections.js"></script>
  <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
  <!-- BEGIN Doxygen Awesome -->
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeParagraphLink.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
  </script>
  <script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeTabs.init()
  </script>
  <!-- END Doxygen Awesome -->
  <link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
  <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
  <link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="../../pbat.svg"  /></td>
              <td id="projectalign">
                <div id="projectname">PhysicsBasedAnimationToolkit<span
                    id="projectnumber">&#160;0.0.10</span>
                </div>
                <div id="projectbrief">Cross-platform C++20 library of algorithms and data structures commonly used in computer graphics research on physically-based simulation.</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../dd/dc5/classpbat_1_1sim_1_1integration_1_1_bdf-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pbat::sim::integration::Bdf&lt; TScalar, TIndex &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>BDF (Backward Differentiation Formula) time integration scheme for a system of ODEs for an initial value problem (IVP)  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../dc/ddc/_bdf_8h_source.html">Bdf.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a7628d153284e6be30695b2e4391798f6" id="r_a7628d153284e6be30695b2e4391798f6"><td class="memItemLeft" align="right" valign="top"><a id="a7628d153284e6be30695b2e4391798f6" name="a7628d153284e6be30695b2e4391798f6"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>ScalarType</b> = TScalar</td></tr>
<tr class="memdesc:a7628d153284e6be30695b2e4391798f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Floating point scalar type. <br /></td></tr>
<tr class="separator:a7628d153284e6be30695b2e4391798f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0261a4111a2abd8feae902448f182204" id="r_a0261a4111a2abd8feae902448f182204"><td class="memItemLeft" align="right" valign="top"><a id="a0261a4111a2abd8feae902448f182204" name="a0261a4111a2abd8feae902448f182204"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>IndexType</b> = TIndex</td></tr>
<tr class="memdesc:a0261a4111a2abd8feae902448f182204"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer index type. <br /></td></tr>
<tr class="separator:a0261a4111a2abd8feae902448f182204"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa7d4fce04159ba077ca443c0e47bc9b9" id="r_aa7d4fce04159ba077ca443c0e47bc9b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7d4fce04159ba077ca443c0e47bc9b9">Bdf</a> (int step=1, int order=2)</td></tr>
<tr class="memdesc:aa7d4fce04159ba077ca443c0e47bc9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <code>step</code>-step BDF (backward differentiation formula) time integration scheme for a system of ODEs (ordinary differential equation) of order <code>order</code>.  <br /></td></tr>
<tr class="separator:aa7d4fce04159ba077ca443c0e47bc9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0538e4357316881ccc61e9013b96f745" id="r_a0538e4357316881ccc61e9013b96f745"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0538e4357316881ccc61e9013b96f745">Order</a> () const</td></tr>
<tr class="memdesc:a0538e4357316881ccc61e9013b96f745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Order of the ODE.  <br /></td></tr>
<tr class="separator:a0538e4357316881ccc61e9013b96f745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c60a4438e4925335e81d29bb380100" id="r_a42c60a4438e4925335e81d29bb380100"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42c60a4438e4925335e81d29bb380100">Step</a> () const</td></tr>
<tr class="memdesc:a42c60a4438e4925335e81d29bb380100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step <code>s</code> of the <code>s</code>-step BDF scheme.  <br /></td></tr>
<tr class="separator:a42c60a4438e4925335e81d29bb380100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d26d206a12eefcabe183bbb50d1157" id="r_a95d26d206a12eefcabe183bbb50d1157"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95d26d206a12eefcabe183bbb50d1157">Dimensions</a> () const</td></tr>
<tr class="memdesc:a95d26d206a12eefcabe183bbb50d1157"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of ODEs.  <br /></td></tr>
<tr class="separator:a95d26d206a12eefcabe183bbb50d1157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0e3a3fa2050521adf630de2f6f3b83" id="r_afa0e3a3fa2050521adf630de2f6f3b83"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa0e3a3fa2050521adf630de2f6f3b83">TimeStep</a> () const</td></tr>
<tr class="memdesc:afa0e3a3fa2050521adf630de2f6f3b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time step size.  <br /></td></tr>
<tr class="separator:afa0e3a3fa2050521adf630de2f6f3b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace90142c081064694253172b0ba459eb" id="r_ace90142c081064694253172b0ba459eb"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace90142c081064694253172b0ba459eb">Inertia</a> (int o) const</td></tr>
<tr class="memdesc:ace90142c081064694253172b0ba459eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inertia of the BDF scheme for the \( o^\text{th} \) state derivative.  <br /></td></tr>
<tr class="separator:ace90142c081064694253172b0ba459eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16512ae20d79c27538d0c2133f4a06b0" id="r_a16512ae20d79c27538d0c2133f4a06b0"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16512ae20d79c27538d0c2133f4a06b0">State</a> (int k, int o=0) const -&gt; decltype(xt.col(0))</td></tr>
<tr class="memdesc:a16512ae20d79c27538d0c2133f4a06b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">\( o^\text{th} \) state derivative  <br /></td></tr>
<tr class="separator:a16512ae20d79c27538d0c2133f4a06b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2550a3bc8d7d49bf388fa2e7e3584852" id="r_a2550a3bc8d7d49bf388fa2e7e3584852"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2550a3bc8d7d49bf388fa2e7e3584852">State</a> (int k, int o=0) -&gt; decltype(xt.col(0))</td></tr>
<tr class="memdesc:a2550a3bc8d7d49bf388fa2e7e3584852"><td class="mdescLeft">&#160;</td><td class="mdescRight">\( o^\text{th} \) state derivative  <br /></td></tr>
<tr class="separator:a2550a3bc8d7d49bf388fa2e7e3584852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526f2de1169bf41af37ea6800f1b17fa" id="r_a526f2de1169bf41af37ea6800f1b17fa"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a526f2de1169bf41af37ea6800f1b17fa">CurrentState</a> (int o=0) const -&gt; decltype(xt.col(0))</td></tr>
<tr class="memdesc:a526f2de1169bf41af37ea6800f1b17fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current state derivative.  <br /></td></tr>
<tr class="separator:a526f2de1169bf41af37ea6800f1b17fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ff7e500841cb3fc9198190526bcb45" id="r_a28ff7e500841cb3fc9198190526bcb45"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28ff7e500841cb3fc9198190526bcb45">CurrentState</a> (int o=0) -&gt; decltype(xt.col(0))</td></tr>
<tr class="memdesc:a28ff7e500841cb3fc9198190526bcb45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current state derivative.  <br /></td></tr>
<tr class="separator:a28ff7e500841cb3fc9198190526bcb45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea27f74eda229507b783ae866f48eba4" id="r_aea27f74eda229507b783ae866f48eba4"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea27f74eda229507b783ae866f48eba4">Alpha</a> () const</td></tr>
<tr class="memdesc:aea27f74eda229507b783ae866f48eba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolation coefficients \( \alpha_k \) except \( \alpha_s \).  <br /></td></tr>
<tr class="separator:aea27f74eda229507b783ae866f48eba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bee437065791bcbdb0a3158211fc45a" id="r_a1bee437065791bcbdb0a3158211fc45a"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bee437065791bcbdb0a3158211fc45a">Beta</a> () const</td></tr>
<tr class="memdesc:a1bee437065791bcbdb0a3158211fc45a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forcing term coefficient \( \beta \) s.t. \( \tilde{\beta} = h \beta \).  <br /></td></tr>
<tr class="separator:a1bee437065791bcbdb0a3158211fc45a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49e6323d8001923115cb2b24458f3aa2" id="r_a49e6323d8001923115cb2b24458f3aa2"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49e6323d8001923115cb2b24458f3aa2">BetaTilde</a> () const</td></tr>
<tr class="memdesc:a49e6323d8001923115cb2b24458f3aa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time-step scaled forcing term coefficient \( \tilde{\beta} = h \beta \).  <br /></td></tr>
<tr class="separator:a49e6323d8001923115cb2b24458f3aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a707b84bdc199a0ce997ea9ea3dfed2ad" id="r_a707b84bdc199a0ce997ea9ea3dfed2ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a707b84bdc199a0ce997ea9ea3dfed2ad">SetOrder</a> (int order)</td></tr>
<tr class="memdesc:a707b84bdc199a0ce997ea9ea3dfed2ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the order of the ODE system.  <br /></td></tr>
<tr class="separator:a707b84bdc199a0ce997ea9ea3dfed2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a648f5c3e33e805896d87a0ed410638b9" id="r_a648f5c3e33e805896d87a0ed410638b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a648f5c3e33e805896d87a0ed410638b9">SetStep</a> (int step)</td></tr>
<tr class="memdesc:a648f5c3e33e805896d87a0ed410638b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the step of the BDF scheme.  <br /></td></tr>
<tr class="separator:a648f5c3e33e805896d87a0ed410638b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25aa24d9c1e37276e78414c85db2da97" id="r_a25aa24d9c1e37276e78414c85db2da97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a25aa24d9c1e37276e78414c85db2da97">SetTimeStep</a> (<a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a> dt)</td></tr>
<tr class="memdesc:a25aa24d9c1e37276e78414c85db2da97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time step size.  <br /></td></tr>
<tr class="separator:a25aa24d9c1e37276e78414c85db2da97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed966e43b1b15bc085c41bc2435347a" id="r_aaed966e43b1b15bc085c41bc2435347a"><td class="memItemLeft" align="right" valign="top"><a id="aaed966e43b1b15bc085c41bc2435347a" name="aaed966e43b1b15bc085c41bc2435347a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ConstructEquations</b> ()</td></tr>
<tr class="memdesc:aaed966e43b1b15bc085c41bc2435347a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the BDF equations, i.e. compute  \( \tilde{x^{(o)}} = \sum_{k=0}^{s-1}
\alpha_k x^{(o)}_{t_i - s + k} \) for all \( o = 0, ..., \text{order}-1 \). <br /></td></tr>
<tr class="separator:aaed966e43b1b15bc085c41bc2435347a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe6a302df1ee1b9f8e6659ca9503e54" id="r_a0fe6a302df1ee1b9f8e6659ca9503e54"><td class="memTemplParams" colspan="2">template&lt;class TDerivedX&gt; </td></tr>
<tr class="memitem:a0fe6a302df1ee1b9f8e6659ca9503e54"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a0fe6a302df1ee1b9f8e6659ca9503e54">SetInitialConditions</a> (Eigen::DenseBase&lt; TDerivedX &gt; const &amp;x0)</td></tr>
<tr class="memdesc:a0fe6a302df1ee1b9f8e6659ca9503e54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the initial conditions for the initial value problem.  <br /></td></tr>
<tr class="separator:a0fe6a302df1ee1b9f8e6659ca9503e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42bc44f568207c265995fc6273ee453f" id="r_a42bc44f568207c265995fc6273ee453f"><td class="memTemplParams" colspan="2">template&lt;class... TDerivedX&gt; </td></tr>
<tr class="memitem:a42bc44f568207c265995fc6273ee453f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a42bc44f568207c265995fc6273ee453f">SetInitialConditions</a> (Eigen::DenseBase&lt; TDerivedX &gt; const &amp;... x0)</td></tr>
<tr class="memdesc:a42bc44f568207c265995fc6273ee453f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the initial conditions for the initial value problem.  <br /></td></tr>
<tr class="separator:a42bc44f568207c265995fc6273ee453f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f84d3df4fd573641b495b6bb795be7a" id="r_a5f84d3df4fd573641b495b6bb795be7a"><td class="memTemplParams" colspan="2">template&lt;class TDerivedX&gt; </td></tr>
<tr class="memitem:a5f84d3df4fd573641b495b6bb795be7a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5f84d3df4fd573641b495b6bb795be7a">Step</a> (Eigen::DenseBase&lt; TDerivedX &gt; const &amp;x)</td></tr>
<tr class="memdesc:a5f84d3df4fd573641b495b6bb795be7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance the BDF scheme by one time step.  <br /></td></tr>
<tr class="separator:a5f84d3df4fd573641b495b6bb795be7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3630b20aa12f5767b5015bbb5211249" id="r_af3630b20aa12f5767b5015bbb5211249"><td class="memTemplParams" colspan="2">template&lt;class... TDerivedX&gt; </td></tr>
<tr class="memitem:af3630b20aa12f5767b5015bbb5211249"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#af3630b20aa12f5767b5015bbb5211249">Step</a> (Eigen::DenseBase&lt; TDerivedX &gt; const &amp;... xs)</td></tr>
<tr class="memdesc:af3630b20aa12f5767b5015bbb5211249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance the BDF scheme by one time step.  <br /></td></tr>
<tr class="separator:af3630b20aa12f5767b5015bbb5211249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ae9d7160d76f518bc286c7d544a579" id="r_ac7ae9d7160d76f518bc286c7d544a579"><td class="memItemLeft" align="right" valign="top"><a id="ac7ae9d7160d76f518bc286c7d544a579" name="ac7ae9d7160d76f518bc286c7d544a579"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Tick</b> ()</td></tr>
<tr class="memdesc:ac7ae9d7160d76f518bc286c7d544a579"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance the BDF scheme by one time step. <br /></td></tr>
<tr class="separator:ac7ae9d7160d76f518bc286c7d544a579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81cf679f7838c9d5b6390bbc6309705c" id="r_a81cf679f7838c9d5b6390bbc6309705c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81cf679f7838c9d5b6390bbc6309705c">Serialize</a> (<a class="el" href="../../d0/de5/classpbat_1_1io_1_1_archive.html">io::Archive</a> &amp;archive) const</td></tr>
<tr class="memdesc:a81cf679f7838c9d5b6390bbc6309705c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize to HDF5 group.  <br /></td></tr>
<tr class="separator:a81cf679f7838c9d5b6390bbc6309705c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b181b1e9977117b6c92245fbec6339" id="r_a83b181b1e9977117b6c92245fbec6339"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83b181b1e9977117b6c92245fbec6339">Deserialize</a> (<a class="el" href="../../d0/de5/classpbat_1_1io_1_1_archive.html">io::Archive</a> const &amp;archive)</td></tr>
<tr class="memdesc:a83b181b1e9977117b6c92245fbec6339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize from HDF5 group.  <br /></td></tr>
<tr class="separator:a83b181b1e9977117b6c92245fbec6339"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a589a5522ae23fac56bd6ab284c638c14" id="r_a589a5522ae23fac56bd6ab284c638c14"><td class="memItemLeft" align="right" valign="top">Eigen::Matrix&lt; <a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a>, Eigen::Dynamic, Eigen::Dynamic &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a589a5522ae23fac56bd6ab284c638c14">xt</a></td></tr>
<tr class="separator:a589a5522ae23fac56bd6ab284c638c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0b47600b093d3dbc3474bbda7d9338" id="r_a7a0b47600b093d3dbc3474bbda7d9338"><td class="memItemLeft" align="right" valign="top">Eigen::Matrix&lt; <a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a>, Eigen::Dynamic, Eigen::Dynamic &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a0b47600b093d3dbc3474bbda7d9338">xtilde</a></td></tr>
<tr class="separator:a7a0b47600b093d3dbc3474bbda7d9338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f4ea690b05862bc2103f9ca21ce01c1" id="r_a6f4ea690b05862bc2103f9ca21ce01c1"><td class="memItemLeft" align="right" valign="top"><a id="a6f4ea690b05862bc2103f9ca21ce01c1" name="a6f4ea690b05862bc2103f9ca21ce01c1"></a>
<a class="el" href="#a0261a4111a2abd8feae902448f182204">IndexType</a>&#160;</td><td class="memItemRight" valign="bottom"><b>ti</b></td></tr>
<tr class="memdesc:a6f4ea690b05862bc2103f9ca21ce01c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current time index s.t. \(t = t_0 + h t_i\). <br /></td></tr>
<tr class="separator:a6f4ea690b05862bc2103f9ca21ce01c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1740820e0fb934fd010c82ec88d00b4c" id="r_a1740820e0fb934fd010c82ec88d00b4c"><td class="memItemLeft" align="right" valign="top"><a id="a1740820e0fb934fd010c82ec88d00b4c" name="a1740820e0fb934fd010c82ec88d00b4c"></a>
<a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a>&#160;</td><td class="memItemRight" valign="bottom"><b>h</b></td></tr>
<tr class="memdesc:a1740820e0fb934fd010c82ec88d00b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time step size \( h \). <br /></td></tr>
<tr class="separator:a1740820e0fb934fd010c82ec88d00b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class TScalar = Scalar, class TIndex = Index&gt;<br />
class pbat::sim::integration::Bdf&lt; TScalar, TIndex &gt;</div><p>BDF (Backward Differentiation Formula) time integration scheme for a system of ODEs for an initial value problem (IVP) </p>
<p>Refer to background <a href="https://en.wikipedia.org/wiki/Backward_differentiation_formula">here</a>.</p>
<p>An order \( p \) system of ODEs \( x^{(p)} = f(t, \frac{d^{p-1}}{dt^{p-1}} x, \dots, x) \) can be transformed into a system of \( p \) first-order ODEs using slack variables  \( x^{(o)}
   = \frac{d^o}{dt^o} x \) for \( o = 0, \dots, p-1 \), such that the IVP can be rewritten as      </p><p class="formulaDsp">
\[   \begin{align*}
   \frac{d}{dt} x_{p-1} &amp;= f(t, x^{(p-1)}, \dots, x^{(o)}) \\
   \frac{d}{dt} x^{(p-j)} &amp;= x^{(p-j+1)}, \quad j = 2, \dots, p
   \end{align*} .
\]
</p>
<p>Since BDF discretizes each equation as  \( \sum_{k=0}^s \alpha_k x_{n-s+k} = h \beta f(t,
   x_n^{(p-1)}, \dots, x_n) \), we have that      </p><p class="formulaDsp">
\[   \begin{align*}
   x^{(p-1)}_n + \tilde{x}^{(p-1)}_\text{BDFS} - \tilde{\beta}_\text{BDFS} f(t, x_n^{(p-1)}, \dots,
   x_n) &amp;= 0 \\ x^{(o)}_n + \tilde{x}^{(o)}_\text{BDFS} - \tilde{\beta}_\text{BDFS} x^{(o+1)}_n &amp;= 0
   \end{align*}
\]
</p>
<p> for \( o=0,\dots,p-2 \), where \( \tilde{\beta} = h \beta \) and \( n \) is the next time step index.</p>
<p>One performs time integration by solving for the states and their derivatives \( x_n^{(o)} \) for \( o=0,\dots,p-1 \) at each time step using root-finding of the above equations. Alternatively, the root-finding equations can be treated as stationarity conditions \( \nabla f = 0 \) for some objective function \( f \), and solved via numerical optimization of \( f \).</p>
<p>This class encapsulates the storage of the past states and their lower order derivatives  \(   x_{n-s+k}^{(o)} \), the construction of so-called inertias \( \tilde{x}^{(o)}_\text{BDFS} \), the interpolation coefficients \( \alpha_k \), forcing term coefficient \( \beta \) and generalize the BDF scheme to various ODE systems of different orders. Specific ODEs are then entirely defined by the forcing function \( f(t, \frac{d^{p-1}}{dt^{p-1}} x, \dots, x) \), and it is up to the user to derive their specific equations to solve.</p>
<div class="fragment"><div class="line">bdf.SetInitialConditions(x0, v0)</div>
<div class="line"><span class="keywordflow">for</span> <a class="code hl_variable" href="#a6f4ea690b05862bc2103f9ca21ce01c1">ti</a> in steps:</div>
<div class="line">  bdf.ConstructEquations()</div>
<div class="line">  xn, vn = userSolve(bdf)</div>
<div class="line">  bdf.Step(xn, vn)</div>
<div class="ttc" id="aclasspbat_1_1sim_1_1integration_1_1_bdf_html_a6f4ea690b05862bc2103f9ca21ce01c1"><div class="ttname"><a href="#a6f4ea690b05862bc2103f9ca21ce01c1">pbat::sim::integration::Bdf::ti</a></div><div class="ttdeci">IndexType ti</div><div class="ttdoc">Current time index s.t. .</div><div class="ttdef"><b>Definition</b> Bdf.h:100</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa7d4fce04159ba077ca443c0e47bc9b9" name="aa7d4fce04159ba077ca443c0e47bc9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d4fce04159ba077ca443c0e47bc9b9">&#9670;&#160;</a></span>Bdf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Bdf </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>step</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a <code>step</code>-step BDF (backward differentiation formula) time integration scheme for a system of ODEs (ordinary differential equation) of order <code>order</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">step</td><td><code>0 &lt; s &lt; 7</code> backward differentiation scheme </td></tr>
    <tr><td class="paramname">order</td><td><code>order &gt; 0</code> order of the ODE </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>0 &lt; step &lt; 7</code> </dd>
<dd>
<code>order &gt; 0</code> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aea27f74eda229507b783ae866f48eba4" name="aea27f74eda229507b783ae866f48eba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea27f74eda229507b783ae866f48eba4">&#9670;&#160;</a></span>Alpha()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Alpha </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interpolation coefficients \( \alpha_k \) except \( \alpha_s \). </p>
<dl class="section return"><dt>Returns</dt><dd><code>s x 1</code> vector of interpolation coefficients \( \alpha_k \) </dd></dl>

</div>
</div>
<a id="a1bee437065791bcbdb0a3158211fc45a" name="a1bee437065791bcbdb0a3158211fc45a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bee437065791bcbdb0a3158211fc45a">&#9670;&#160;</a></span>Beta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Beta </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forcing term coefficient \( \beta \) s.t. \( \tilde{\beta} = h \beta \). </p>
<dl class="section return"><dt>Returns</dt><dd>Forcing term coefficient \( \beta \) </dd></dl>

</div>
</div>
<a id="a49e6323d8001923115cb2b24458f3aa2" name="a49e6323d8001923115cb2b24458f3aa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e6323d8001923115cb2b24458f3aa2">&#9670;&#160;</a></span>BetaTilde()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::BetaTilde </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Time-step scaled forcing term coefficient \( \tilde{\beta} = h \beta \). </p>
<dl class="section return"><dt>Returns</dt><dd>Time-step scaled forcing term coefficient \( \tilde{\beta} = h \beta \) </dd></dl>

</div>
</div>
<a id="a28ff7e500841cb3fc9198190526bcb45" name="a28ff7e500841cb3fc9198190526bcb45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ff7e500841cb3fc9198190526bcb45">&#9670;&#160;</a></span>CurrentState() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::CurrentState </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>o</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> -&gt; decltype(xt.col(0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current state derivative. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>Order of the state derivative \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>n x 1</code> current state derivative vector \( x^{(o)}_{t_i} \) </dd></dl>

</div>
</div>
<a id="a526f2de1169bf41af37ea6800f1b17fa" name="a526f2de1169bf41af37ea6800f1b17fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a526f2de1169bf41af37ea6800f1b17fa">&#9670;&#160;</a></span>CurrentState() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::CurrentState </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>o</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const -&gt; decltype(xt.col(0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current state derivative. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>Order of the state derivative \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>n x 1</code> current state derivative vector \( x^{(o)}_{t_i} \) </dd></dl>

</div>
</div>
<a id="a83b181b1e9977117b6c92245fbec6339" name="a83b181b1e9977117b6c92245fbec6339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83b181b1e9977117b6c92245fbec6339">&#9670;&#160;</a></span>Deserialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Deserialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/de5/classpbat_1_1io_1_1_archive.html">io::Archive</a> const &amp;</td>          <td class="paramname"><span class="paramname"><em>archive</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize from HDF5 group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">archive</td><td>Archive to deserialize from </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a95d26d206a12eefcabe183bbb50d1157" name="a95d26d206a12eefcabe183bbb50d1157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d26d206a12eefcabe183bbb50d1157">&#9670;&#160;</a></span>Dimensions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Dimensions </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of ODEs. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of ODEs </dd></dl>

</div>
</div>
<a id="ace90142c081064694253172b0ba459eb" name="ace90142c081064694253172b0ba459eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace90142c081064694253172b0ba459eb">&#9670;&#160;</a></span>Inertia()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Inertia </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inertia of the BDF scheme for the \( o^\text{th} \) state derivative. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>Order of the state derivative \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>n x 1</code> inertia vector for the \( o^\text{th} \) state derivative </dd></dl>

</div>
</div>
<a id="a0538e4357316881ccc61e9013b96f745" name="a0538e4357316881ccc61e9013b96f745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0538e4357316881ccc61e9013b96f745">&#9670;&#160;</a></span>Order()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Order </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Order of the ODE. </p>
<dl class="section return"><dt>Returns</dt><dd>Order of the ODE </dd></dl>

</div>
</div>
<a id="a81cf679f7838c9d5b6390bbc6309705c" name="a81cf679f7838c9d5b6390bbc6309705c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81cf679f7838c9d5b6390bbc6309705c">&#9670;&#160;</a></span>Serialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Serialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/de5/classpbat_1_1io_1_1_archive.html">io::Archive</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>archive</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize to HDF5 group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">archive</td><td>Archive to serialize to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a42bc44f568207c265995fc6273ee453f" name="a42bc44f568207c265995fc6273ee453f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42bc44f568207c265995fc6273ee453f">&#9670;&#160;</a></span>SetInitialConditions() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
<div class="memtemplate">
template&lt;class... TDerivedX&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::SetInitialConditions </td>
          <td>(</td>
          <td class="paramtype">Eigen::DenseBase&lt; TDerivedX &gt; const &amp;...</td>          <td class="paramname"><span class="paramname"><em>x0</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the initial conditions for the initial value problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x0</td><td><code>order</code> vectors of <code>n x 1</code> initial conditions \( x^{(o)}_{t_0} \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>sizeof...(TDerivedX) == order</code> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>ti == 0</code> </dd></dl>

</div>
</div>
<a id="a0fe6a302df1ee1b9f8e6659ca9503e54" name="a0fe6a302df1ee1b9f8e6659ca9503e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe6a302df1ee1b9f8e6659ca9503e54">&#9670;&#160;</a></span>SetInitialConditions() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
<div class="memtemplate">
template&lt;class TDerivedX&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::SetInitialConditions </td>
          <td>(</td>
          <td class="paramtype">Eigen::DenseBase&lt; TDerivedX &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>x0</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the initial conditions for the initial value problem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x0</td><td><code>n x order</code> matrix of initial conditions s.t. <code>x0.col(o) = \f$ x^{(o)}_{t_0} \f$</code> for \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>x0.cols() == order</code> </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>ti == 0</code> </dd></dl>

</div>
</div>
<a id="a707b84bdc199a0ce997ea9ea3dfed2ad" name="a707b84bdc199a0ce997ea9ea3dfed2ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a707b84bdc199a0ce997ea9ea3dfed2ad">&#9670;&#160;</a></span>SetOrder()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::SetOrder </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>order</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the order of the ODE system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>Order of the ODE system \( \text{order} &gt; 0 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>order &gt; 0</code> </dd></dl>

</div>
</div>
<a id="a648f5c3e33e805896d87a0ed410638b9" name="a648f5c3e33e805896d87a0ed410638b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a648f5c3e33e805896d87a0ed410638b9">&#9670;&#160;</a></span>SetStep()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::SetStep </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>step</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the step of the BDF scheme. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">step</td><td>Step of the BDF scheme \( 0 &lt; s &lt; 7 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>0 &lt; step &lt; 7</code> </dd></dl>

</div>
</div>
<a id="a25aa24d9c1e37276e78414c85db2da97" name="a25aa24d9c1e37276e78414c85db2da97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25aa24d9c1e37276e78414c85db2da97">&#9670;&#160;</a></span>SetTimeStep()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::SetTimeStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a></td>          <td class="paramname"><span class="paramname"><em>dt</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the time step size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>Time step size \( dt &gt; 0 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>dt &gt; 0</code> </dd></dl>

</div>
</div>
<a id="a2550a3bc8d7d49bf388fa2e7e3584852" name="a2550a3bc8d7d49bf388fa2e7e3584852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2550a3bc8d7d49bf388fa2e7e3584852">&#9670;&#160;</a></span>State() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::State </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>o</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) -&gt; decltype(xt.col(0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\( o^\text{th} \) state derivative </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>State index \( k = 0, ..., s \) for the vector \( x^{(o)}_{t_i - s + k} \) </td></tr>
    <tr><td class="paramname">o</td><td>Order of the state derivative \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>n x 1</code> state derivative vector \( x^{(o)}_{t_i - s + k} \) </dd></dl>

</div>
</div>
<a id="a16512ae20d79c27538d0c2133f4a06b0" name="a16512ae20d79c27538d0c2133f4a06b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16512ae20d79c27538d0c2133f4a06b0">&#9670;&#160;</a></span>State() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::State </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>o</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const -&gt; decltype(xt.col(0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>\( o^\text{th} \) state derivative </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>State index \( k = 0, ..., s \) for the vector \( x^{(o)}_{t_i - s + k} \) </td></tr>
    <tr><td class="paramname">o</td><td>Order of the state derivative \( o = 0, ..., \text{order}-1 \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>n x 1</code> state derivative vector \( x^{(o)}_{t_i - s + k} \) </dd></dl>

</div>
</div>
<a id="a42c60a4438e4925335e81d29bb380100" name="a42c60a4438e4925335e81d29bb380100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42c60a4438e4925335e81d29bb380100">&#9670;&#160;</a></span>Step() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Step </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Step <code>s</code> of the <code>s</code>-step BDF scheme. </p>
<dl class="section return"><dt>Returns</dt><dd>Step <code>s</code> of the <code>s</code>-step BDF scheme </dd></dl>

</div>
</div>
<a id="af3630b20aa12f5767b5015bbb5211249" name="af3630b20aa12f5767b5015bbb5211249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3630b20aa12f5767b5015bbb5211249">&#9670;&#160;</a></span>Step() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
<div class="memtemplate">
template&lt;class... TDerivedX&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Step </td>
          <td>(</td>
          <td class="paramtype">Eigen::DenseBase&lt; TDerivedX &gt; const &amp;...</td>          <td class="paramname"><span class="paramname"><em>xs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advance the BDF scheme by one time step. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDerivedX</td><td>Derived type of the input matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xs</td><td><code>order</code> vectors of <code>n x 1</code> current state derivatives \( x_{t_i}^{(o)} \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>sizeof...(TDerivedX) == order</code> </dd></dl>

</div>
</div>
<a id="a5f84d3df4fd573641b495b6bb795be7a" name="a5f84d3df4fd573641b495b6bb795be7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f84d3df4fd573641b495b6bb795be7a">&#9670;&#160;</a></span>Step() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar, class TIndex&gt; </div>
<div class="memtemplate">
template&lt;class TDerivedX&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::Step </td>
          <td>(</td>
          <td class="paramtype">Eigen::DenseBase&lt; TDerivedX &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advance the BDF scheme by one time step. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TDerivedX</td><td>Derived type of the input matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td><code>n x order</code> matrix of the current state derivatives \( x_{t_i}^{(o)} \) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afa0e3a3fa2050521adf630de2f6f3b83" name="afa0e3a3fa2050521adf630de2f6f3b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0e3a3fa2050521adf630de2f6f3b83">&#9670;&#160;</a></span>TimeStep()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::TimeStep </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Time step size. </p>
<dl class="section return"><dt>Returns</dt><dd>Time step size </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a589a5522ae23fac56bd6ab284c638c14" name="a589a5522ae23fac56bd6ab284c638c14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a589a5522ae23fac56bd6ab284c638c14">&#9670;&#160;</a></span>xt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Eigen::Matrix&lt;<a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a>, Eigen::Dynamic, Eigen::Dynamic&gt; <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::xt</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>n x |s*order|</code> matrix of <code>n</code>-dimensional states and their time derivatives s.t. \( xt.col(o*s + k) = x^(k)(t - k*dt) \) for \( k = 0, ..., s \) and \( o = 0, ..., \text{order}-1 \) </p>

</div>
</div>
<a id="a7a0b47600b093d3dbc3474bbda7d9338" name="a7a0b47600b093d3dbc3474bbda7d9338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0b47600b093d3dbc3474bbda7d9338">&#9670;&#160;</a></span>xtilde</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class TScalar = Scalar, class TIndex = Index&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Eigen::Matrix&lt;<a class="el" href="#a7628d153284e6be30695b2e4391798f6">ScalarType</a>, Eigen::Dynamic, Eigen::Dynamic&gt; <a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">pbat::sim::integration::Bdf</a>&lt; TScalar, TIndex &gt;::xtilde</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>n x order</code> matrix of <code>n</code>-dimensional aggregated past states and time derivatives s.t. xtilde.col(o) =  \( \frac{1}{\alpha_s} \sum_{k=t_i-s}^{s-1}
&lt; \alpha_k x_k \) for \( o = 0, ..., \text{order}-1 \) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/git/PhysicsBasedAnimationToolkit/source/pbat/sim/integration/<a class="el" href="../../dc/ddc/_bdf_8h_source.html">Bdf.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d7c/namespacepbat.html">pbat</a></li><li class="navelem"><a class="el" href="../../d3/dcb/namespacepbat_1_1sim.html">sim</a></li><li class="navelem"><a class="el" href="../../de/d92/namespacepbat_1_1sim_1_1integration.html">integration</a></li><li class="navelem"><a class="el" href="../../d4/d16/classpbat_1_1sim_1_1integration_1_1_bdf.html">Bdf</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
